---
title: 基本使用
date: 2022-05-14 17:11:33
permalink: /pages/aea3c6/
categories:
  - 前端
  - React
  - Redux
tags:
  - 
---

## 定时器

用`hooks`写一个定时器例子：

<<<@/codes/react-demo/src/pages/redux/count/old.jsx

## 用redux进行改写

因为创建`store`需要传入`reducer`，我们先实现一个定时器`reducer`，可以使用`createSlice`帮忙，它会帮我们根据我们定义的`reducer`自动生成相关`actions`

`createSlice`函数的结构如下：

```js
const slice = createSlice({
  name: 切片名字,
  initialState: 初始状态
  reducers: reducer函数对象，key值作为reducer名称和action名称
})

const {actions , reducer} = slice // 自动生成reducer和actions
//  通过actions.foo()来生成action对象，对象默认为{type : 切片名称 + reducer名称}
```

<<<@/codes/react-demo/src/pages/redux/count/counterSlice.js

-   在`store`引入刚才创建的`reducer`
-   通过`configureStore`帮我们创建一个`store`对象

<<<@/codes/react-demo/src/pages/redux/count/store.js

-   引入`store`对象
-   从`react-redux`中引入`Provider`组件
-   用`Provider组件`包裹住我们要使用`redux`的组件，使其能够获取到`store`对象。

```js
import { Provider } from 'react-redux'
import store from './store'

function App() {
    return (
        <Provider store={store}>
            <Counter />
        </Provider>
    )
}
export default App
```

-   引入我们刚才自动生成的`action`生成器`increment`，我们可以用`increment()`生成`action对象`，并用于`dispatch`通知`reducer`
-   从`react-redux`引入`useDispatch`，它会向上找到一个`Provider`，并从中取出`store.dispatch`
-   从`react-redux`引入`useSelector`，它接收一个回调函数，`(state)=>returnValue`，你可以在回调函数中操作整个`state`对象，并获取需要的数据

完整代码

<<<@/codes/react-demo/src/pages/redux/count/index.jsx